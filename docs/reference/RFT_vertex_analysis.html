<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Vertex-wise analysis with random field theory cluster correction — RFT_vertex_analysis • VertexWiseR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vertex-wise analysis with random field theory cluster correction — RFT_vertex_analysis"><meta name="description" content="Fits a linear or linear mixed model with the cortical or hippocampal surface data as the predicted outcome, and returns cluster-thresholded (Random field theory) t-stat map selected contrast."><meta property="og:description" content="Fits a linear or linear mixed model with the cortical or hippocampal surface data as the predicted outcome, and returns cluster-thresholded (Random field theory) t-stat map selected contrast."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VertexWiseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Python_troubleshooting.html">Python troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_Example_1.html">Example analyses with VertexWiseR - Example 1</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_Example_2.html">Example analyses with VertexWiseR - Example 2</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_surface_extraction.html">Extracting surface data in VertexWiseR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Updates</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vertex-wise analysis with random field theory cluster correction</h1>

      <div class="d-none name"><code>RFT_vertex_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a linear or linear mixed model with the cortical or hippocampal surface data as the predicted outcome, and returns cluster-thresholded (Random field theory) t-stat map selected contrast.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RFT_vertex_analysis</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">contrast</span>,</span>
<span>  <span class="va">random</span>,</span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">formula_dataset</span>,</span>
<span>  <span class="va">surf_data</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  atlas <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">smooth_FWHM</span>,</span>
<span>  VWR_check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>An N X P data.frame object containing N rows for each subject and P columns for each predictor included in the model. This data.frame should not include the random effects variable.</p></dd>


<dt id="arg-contrast">contrast<a class="anchor" aria-label="anchor" href="#arg-contrast"></a></dt>
<dd><p>A N x 1 numeric vector or object containing the values of the predictor of interest. Its length should equal the number of subjects in model (and can be a single column from model). The cluster-thresholded t-stat maps will be estimated only for this predictor.</p></dd>


<dt id="arg-random">random<a class="anchor" aria-label="anchor" href="#arg-random"></a></dt>
<dd><p>A N x 1 numeric vector or object containing the values of the random variable (optional). Its length should be equal to the number of subjects in model (it should NOT be inside the model data.frame).</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An optional string or formula object describing the predictors to be fitted against the surface data, replacing the model, contrast, or random arguments. If this argument is used, the formula_dataset argument must also be provided.</p><ul><li><p>The dependent variable is not needed, as it will always be the surface data values.</p></li>
<li><p>The first independent variable in the formula will always be interpreted as the contrast of interest for which to estimate cluster-thresholded t-stat maps.</p></li>
<li><p>Only one random regressor can be given and must be indicated as '(1|variable_name)'.</p></li>
</ul></dd>


<dt id="arg-formula-dataset">formula_dataset<a class="anchor" aria-label="anchor" href="#arg-formula-dataset"></a></dt>
<dd><p>An optional data.frame object containing the independent variables to be used with the formula (the IV names in the formula must match their column names in the dataset).</p></dd>


<dt id="arg-surf-data">surf_data<a class="anchor" aria-label="anchor" href="#arg-surf-data"></a></dt>
<dd><p>A N x V matrix object containing the surface data (N row for each subject, V for each vertex), in fsaverage5 (20484 vertices), fsaverage6 (81924 vertices), fslr32k (64984 vertices) or hippocampal (14524 vertices) space. See also Hipvextract(), SURFvextract() or FSLRvextract output formats. Alternatively, a string object containing the path to the surface object (.rds file) outputted by extraction functions may be given.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A numeric object specifying the p-value to threshold the results (Default is 0.05)</p></dd>


<dt id="arg-atlas">atlas<a class="anchor" aria-label="anchor" href="#arg-atlas"></a></dt>
<dd><p>A numeric integer object corresponding to the atlas of interest.  1=Desikan, 2=Destrieux-148, 3=Glasser-360, 4=Schaefer-100, 5=Schaefer-200, 6=Schaefer-400. Set to <code>1</code> by default. This argument is ignored for hippocampal surfaces.</p></dd>


<dt id="arg-smooth-fwhm">smooth_FWHM<a class="anchor" aria-label="anchor" href="#arg-smooth-fwhm"></a></dt>
<dd><p>A numeric vector object specifying the desired smoothing width in mm</p></dd>


<dt id="arg-vwr-check">VWR_check<a class="anchor" aria-label="anchor" href="#arg-vwr-check"></a></dt>
<dd><p>A boolean object specifying whether to check and validate system requirements. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list object containing the cluster level results, unthresholded t-stat map, thresholded t-stat map, positive, negative and bidirectional cluster maps, and a FDR-corrected p-value map.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function imports and adapts the <a href="https://brainstat.readthedocs.io/en/master/_modules/brainstat/stats/SLM.html#SLM)" class="external-link"> 'BrainStat' Python library</a>.</p>
<p>By default, false discovery rate correction is used together with the Random field theory (RFT) cluster correction. To look at data without any form of cluster correction, users can simply refer to the outputted 'tstat_map'.</p>
<p>Output definitions:</p><ul><li><p><code>nverts</code>: number of vertices in the cluster</p></li>
<li><p><code>P</code>: p-value of the cluster</p></li>
<li><p><code>X, Y and Z</code>: MNI coordinates of the vertex with the highest t-statistic in the cluster.</p></li>
<li><p><code>tstat</code>: t statistic of the vertex with the highest t-statistic in the cluster</p></li>
<li><p><code>region</code>: the region this highest -statistic vertex is located in, as determined/labelled by the selected atlas</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="TFCE_vertex_analysis.html">TFCE_vertex_analysis</a></code>, <code><a href="TFCE_vertex_analysis_mixed.html">TFCE_vertex_analysis_mixed</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">demodata</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'demo_data/SPRENG_behdata_site1.rds'</span>, </span>
<span>package <span class="op">=</span> <span class="st">'VertexWiseR'</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span></span>
<span><span class="va">CTv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">url</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"https://github.com"</span>,</span>
<span><span class="st">"/CogBrainHealthLab/VertexWiseR/blob/main/inst/demo_data/"</span>,</span>
<span><span class="st">"SPRENG_CTv_site1.rds?raw=TRUE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span> </span>
<span></span>
<span><span class="va">vertexwise_model</span><span class="op">=</span><span class="fu">RFT_vertex_analysis</span><span class="op">(</span>model<span class="op">=</span><span class="va">demodata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"age"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>contrast<span class="op">=</span><span class="va">demodata</span><span class="op">[</span>,<span class="st">"age"</span><span class="op">]</span>, surf_data <span class="op">=</span> <span class="va">CTv</span>, atlas<span class="op">=</span><span class="fl">1</span>,p <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>VWR_check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Description of the output:</span></span>
<span><span class="co">#vertexwise_model$cluster_level_results</span></span>
<span></span>
<span><span class="co">#Formula alternative:</span></span>
<span><span class="co">#formula= as.formula("~ age + sex")</span></span>
<span><span class="co">#vertexwise_model=RFT_vertex_analysis(formula=formula, </span></span>
<span><span class="co">#formula_dataset=demodata, surf_data = CTv, atlas=1, p = 0.05, </span></span>
<span><span class="co">#VWR_check=FALSE)</span></span></code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Junhong Yu, Charly Billaud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

