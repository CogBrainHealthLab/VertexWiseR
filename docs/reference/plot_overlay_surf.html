<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Surface overlay plotter — plot_overlay_surf • VertexWiseR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Surface overlay plotter — plot_overlay_surf"><meta name="description" content="Plots surface data in a grid with one or multiple rows in a .png file"><meta property="og:description" content="Plots surface data in a grid with one or multiple rows in a .png file"><meta property="og:image" content="https://cogbrainhealthlab.github.io/VertexWiseR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VertexWiseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Python_troubleshooting.html">Python troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_Example_1.html">Example analyses with VertexWiseR - Example 1</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_Example_2.html">Example analyses with VertexWiseR - Example 2</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_plot_overlay.html">Overlaying plots and transparent thresholding</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_surface_extraction.html">Extracting surface data in VertexWiseR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Updates</a></li>
<li class="nav-item"><a class="nav-link" href="../poster/VertexWiseR_poster_OHBM2025.pdf" title="OHBM 2025 poster" aria-label="OHBM 2025 poster PDF"><span class="fa fa-solid fa-scroll"></span></a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CogBrainHealthLab/VertexWiseR" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Surface overlay plotter</h1>

      <div class="d-none name"><code>plot_overlay_surf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots surface data in a grid with one or multiple rows in a .png file</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_overlay_surf</span><span class="op">(</span></span>
<span>  model_output <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  surf_data_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  surf_data_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">cmap_1</span>,</span>
<span>  <span class="va">cmap_2</span>,</span>
<span>  <span class="va">limits_1</span>,</span>
<span>  <span class="va">limits_2</span>,</span>
<span>  alpha_1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha_2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  colorbar_1 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  colorbar_2 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_nan <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">filename</span>,</span>
<span>  title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  surface <span class="op">=</span> <span class="st">"inflated"</span>,</span>
<span>  overlay_boundaries <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">size</span>,</span>
<span>  <span class="va">zoom</span>,</span>
<span>  transparent_bg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show.plot.window <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  VWR_check <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-output">model_output<a class="anchor" aria-label="anchor" href="#arg-model-output"></a></dt>
<dd><p>A list object outputted by RFT_vertex_analysis() or TFCE_threshold(). The 'tstat_map' will automatically be treated as background map, and the 'thresholded_tstat_map' as overlay map. See surf_data_1 or surf_data_2 to assign any map manually.</p></dd>


<dt id="arg-surf-data-">surf_data_1<a class="anchor" aria-label="anchor" href="#arg-surf-data-"></a></dt>
<dd><p>A numeric vector (length of V), where V is the number of vertices. It can be one row from the output from SURFvextract(), CAT12vextract(), FSLRvextract(), as well as masks or vertex-wise results outputted by analyses functions. This is the background surface.</p></dd>


<dt id="arg-surf-data-">surf_data_2<a class="anchor" aria-label="anchor" href="#arg-surf-data-"></a></dt>
<dd><p>Same as surf_data_1. This is the overlay surface.</p></dd>


<dt id="arg-cmap-">cmap_1<a class="anchor" aria-label="anchor" href="#arg-cmap-"></a></dt>
<dd><p>A string object specifying the name of an existing colormap or a vector of hexadecimal color codes to be used as a custom colormap. The names of existing colormaps are listed in the <a href="https://matplotlib.org/stable/gallery/color/colormap_reference.html" class="external-link">'Matplotlib' plotting library</a>.</p>
<p>Default cmap is set to <code>"Reds"</code> for positive values, <code>"Blues_r"</code> for negative values and <code>"RdBu"</code> when both positive and negative values exist. This is meant for the background surface.</p></dd>


<dt id="arg-cmap-">cmap_2<a class="anchor" aria-label="anchor" href="#arg-cmap-"></a></dt>
<dd><p>Same as cmap_1. This is meant for the overlay surface. Default is the same as cmaps_1, adapted to limits of surf_data_2.</p></dd>


<dt id="arg-limits-">limits_1<a class="anchor" aria-label="anchor" href="#arg-limits-"></a></dt>
<dd><p>A combined pair of numeric vector composed of the lower and upper color scale limits of surf_data_1. When left unspecified, the  symmetrical limits c(-max(abs(surf_data_1),max(abs(surf_data_1))) will be used. If set to NULL, the limits will correspond to the min and max values of surf_data_1. This is meant for the background surface.</p></dd>


<dt id="arg-limits-">limits_2<a class="anchor" aria-label="anchor" href="#arg-limits-"></a></dt>
<dd><p>Same  as limits_1, or also the string object "same". Default is symmetrical limits relative to surf_data_2, while 'same' will apply the exact same limits as for limits_1. This is meant for the overlay surface.</p></dd>


<dt id="arg-alpha-">alpha_1<a class="anchor" aria-label="anchor" href="#arg-alpha-"></a></dt>
<dd><p>A numeric object between 0 and 1 to determine the opacity of the non-empty vertices. Note that this is not a true opacity setting, it will blend the colour into that of the NaN vertices (white if show_nan is FALSE). This is meant for the background surface.</p></dd>


<dt id="arg-alpha-">alpha_2<a class="anchor" aria-label="anchor" href="#arg-alpha-"></a></dt>
<dd><p>Same as alpha_2. This is meant for the overlay surface. Default is the same as alpha_1.</p></dd>


<dt id="arg-colorbar-">colorbar_1<a class="anchor" aria-label="anchor" href="#arg-colorbar-"></a></dt>
<dd><p>A logical object stating whether to include the color bar for the background layer in the plot or not (default is TRUE).</p></dd>


<dt id="arg-colorbar-">colorbar_2<a class="anchor" aria-label="anchor" href="#arg-colorbar-"></a></dt>
<dd><p>A logical object stating whether to include the color bar for the overlay layer in the plot or not (default is TRUE).</p></dd>


<dt id="arg-show-nan">show_nan<a class="anchor" aria-label="anchor" href="#arg-show-nan"></a></dt>
<dd><p>A logical object to determine if the NaN vertices are to be plotted (Default is TRUE). This is meant for the background surface. The overlay surface will always omit NaN vertices to make the background visible.</p></dd>


<dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>A string object containing the desired name of the output .png. Default is 'combined_plots.png' in the R temporary directory (tempdir()).Only filenames with a .png extension are allowed.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A string object for setting the title in the plot. Default is none. For titles that too long to be fully displayed within the plot, we recommend splitting them into multiple lines by inserting "\n".</p></dd>


<dt id="arg-surface">surface<a class="anchor" aria-label="anchor" href="#arg-surface"></a></dt>
<dd><p>A string object containing the name of the type of cortical surface background rendered. Possible options include "white", "smoothwm","pial" and "inflated" (default).</p></dd>


<dt id="arg-overlay-boundaries">overlay_boundaries<a class="anchor" aria-label="anchor" href="#arg-overlay-boundaries"></a></dt>
<dd><p>A logical object stating whether to plot black contour of the overlay layer.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>A combined pair of numeric vector indicating the image dimensions (width and height in pixels). Default is c(1700,400). Note that the size will depend on the inclusion of color bar(s), which will expand the width to ~5% per color bar.</p></dd>


<dt id="arg-zoom">zoom<a class="anchor" aria-label="anchor" href="#arg-zoom"></a></dt>
<dd><p>A numeric value for adjusting the level of zoom on the figures. Default is 1.25.</p></dd>


<dt id="arg-transparent-bg">transparent_bg<a class="anchor" aria-label="anchor" href="#arg-transparent-bg"></a></dt>
<dd><p>A logical object to determine if the background of the image is set to transparent (Default is FALSE).</p></dd>


<dt id="arg-show-plot-window">show.plot.window<a class="anchor" aria-label="anchor" href="#arg-show-plot-window"></a></dt>
<dd><p>A logical object to determine if the generated plot is to be shown within RStudio's plot window</p></dd>


<dt id="arg-vwr-check">VWR_check<a class="anchor" aria-label="anchor" href="#arg-vwr-check"></a></dt>
<dd><p>A boolean object specifying whether to check and validate system requirements. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Outputs the plot as a .png image</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#simulate t-map</span></span></span>
<span class="r-in"><span><span class="va">background</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">20484</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">ROImap_fs5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">'ROImap_fs5'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ROImap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ROImap_fs5</span><span class="op">@</span><span class="va">data</span>,<span class="va">ROImap_fs5</span><span class="op">@</span><span class="va">atlases</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">neg_parts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idx_neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ROImap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">neg_parts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">background</span><span class="op">[</span><span class="va">idx_neg</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx_neg</span><span class="op">)</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pos_parts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span><span class="op">:</span><span class="fl">46</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">idx_pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ROImap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">pos_parts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">background</span><span class="op">[</span><span class="va">idx_pos</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx_pos</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#simulate clusters (randomly picked aparc atlas parcels)</span></span></span>
<span class="r-in"><span><span class="va">idx_sig</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ROImap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="fl">29</span><span class="op">|</span> <span class="va">ROImap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="fl">19</span><span class="op">|</span></span></span>
<span class="r-in"><span>             <span class="va">ROImap</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">==</span><span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">overlay</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">20484</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">overlay</span><span class="op">[</span><span class="va">idx_sig</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span></span></span>
<span class="r-in"><span>                                </span></span>
<span class="r-in"><span><span class="fu">plot_overlay_surf</span><span class="op">(</span>surf_data_1<span class="op">=</span><span class="va">background</span>,</span></span>
<span class="r-in"><span>                surf_data_2<span class="op">=</span><span class="va">overlay</span>,</span></span>
<span class="r-in"><span>                cmap_1<span class="op">=</span><span class="st">'RdBu_r'</span>, cmap_2<span class="op">=</span><span class="st">'Reds'</span>,</span></span>
<span class="r-in"><span>                alpha_1<span class="op">=</span><span class="fl">0.4</span>, alpha_2<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                filename<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/simulated_plot.png"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>               title<span class="op">=</span><span class="st">"Significant effects"</span>,</span></span>
<span class="r-in"><span>               overlay_boundaries<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               VWR_check<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Non-interactive sessions need requirement checks</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Junhong Yu, Charly Billaud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

