<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Python troubleshooting • VertexWiseR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Python troubleshooting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VertexWiseR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Python_troubleshooting.html">Python troubleshooting</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_Example_1.html">Example analyses with VertexWiseR - Example 1</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_Example_2.html">Example analyses with VertexWiseR - Example 2</a></li>
    <li><a class="dropdown-item" href="../articles/VertexWiseR_surface_extraction.html">Extracting surface data in VertexWiseR</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Updates</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Python troubleshooting</h1>
                        <h4 data-toc-skip class="author">Charly Billaud,
Junhong Yu</h4>
            
            <h4 data-toc-skip class="date">2025-03-07</h4>
      

      <div class="d-none name"><code>Python_troubleshooting.Rmd</code></div>
    </div>

    
    
<p>VertexWiseR uses Python functions from various toolboxes that can
flexibly be called and executed in R using the <em>reticulate</em>
package <span class="citation">(Ushey, Allaire, and Tang
2023)</span>. We explain in this article how to solve a number of issues
that may arise from the interaction with Python.</p>
<div class="section level2">
<h2 id="about-the-message-would-you-like-to-create-a-default-python-environment-for-the-reticulate-package-yesnocancel-reticulate-1-41-0">1. About the message: “Would you like to create a default Python
environment for the reticulate package? (Yes/no/cancel)” (reticulate
&lt; 1.41.0)<a class="anchor" aria-label="anchor" href="#about-the-message-would-you-like-to-create-a-default-python-environment-for-the-reticulate-package-yesnocancel-reticulate-1-41-0"></a>
</h2>
<p>As explained in the <a href="https://cogbrainhealthlab.github.io/VertexWiseR/">home page</a>,
this is a pop-up or prompt from the reticulate package. Choosing ‘Yes’
will let reticulate install Python in a virtual environment. This is
entirely optional. Simply choose/click No/Cancel to ignore.</p>
<p>The <a href="https://rstudio.github.io/reticulate/articles/python_packages.html" class="external-link">reticulate
documentation</a> explains:</p>
<blockquote>
<p>When installing Python packages it’s best practice to isolate
&gt;them within a Python environment (a named Python installation
&gt;that exists for a specific project or purpose). This provides a
&gt;measure of isolation, so that updating a Python package for one
&gt;project doesn’t impact other projects. The risk for package
&gt;incompatibilities is significantly higher with Python packages
&gt;than it is with R packages, because unlike CRAN, PyPI does not
&gt;enforce, or even check, if the current versions of packages
&gt;currently available are compatible.</p>
</blockquote>
<p>Note that VertexWiseR will install a stable specific version of
Python itself and of each package it needs to work properly. If users
believe they will be using the Miniconda/Python installation for more
than VertexWiseR and will need to update them, it may be more stable to
install a specific Miniconda/Python environment in a path of their
choice (as allowed by VWRfirstrun()), or to use a reticulate isolated
virtual environment. More details on why using virtual environments can
be found in the <a href="https://rstudio.github.io/reticulate/articles/python_packages.html" class="external-link">reticulate
documentation</a>.</p>
</div>
<div class="section level2">
<h2 id="how-to-make-vwrfirstrun-ignore-the-systems-python-environment-when-starting-a-fresh-installation">2. How to make VWRfirstrun() ignore the system’s Python environment
when starting a fresh installation<a class="anchor" aria-label="anchor" href="#how-to-make-vwrfirstrun-ignore-the-systems-python-environment-when-starting-a-fresh-installation"></a>
</h2>
<p>VertexWiseR will automatically select and run a Python installation
it finds via reticulate, but users may want to prevent this and run
VertexWiseR on a new Python installation of its own. This section
explains how to make <code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code> ignore a previous
Python/Miniconda installation in order to install a new one (which will
<em>not</em> affect the system’s Python libraries).</p>
<p>Firstly, the Python installation path may already be preloaded in the
global environment, via files such as <code>.Renviron</code>,
<code>.Rprofile</code>, <code>.bashrc</code> etc. If that is the case
they should be edited to remove the path of a previous Python
installation, which will avoid reticulate from using those paths
automatically.</p>
<p>Secondly, if the Python paths are not specified in the global
environment, reticulate will then search for a Python installation in
its default locations. This can be avoided with the method below.</p>
<p>To make <code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code> ignore a previous Python
installation, users can set the <code>RETICULATE_PYTHON</code> variable
as <code>NA</code> (in a new R session with a clean workspace) before
running the function:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>RETICULATE_PYTHON<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/VWRfirstrun.html">VWRfirstrun</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>With the above lines, reticulate should fail to load Python and
respond in the same way it would if Python was not previously installed
at all. Therefore, <code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code> will prompt users to
install a new Python environment. After that, <code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code>
will use that newly installed Python environment by default and users
should not need to do this again.</p>
</div>
<div class="section level2">
<h2 id="how-to-make-vwrfirstrun-use-a-specific-python-installation">3. How to make VWRfirstrun() use a specific Python installation<a class="anchor" aria-label="anchor" href="#how-to-make-vwrfirstrun-use-a-specific-python-installation"></a>
</h2>
<p>This section explains how users can choose a different Python other
than the one automatically detected if they wish to, instead of
installing a new one.</p>
<div class="section level3">
<h3 id="a--for-a-new-fresh-vertexwiser-set-up">a. For a new, fresh VertexWiseR set-up<a class="anchor" aria-label="anchor" href="#a--for-a-new-fresh-vertexwiser-set-up"></a>
</h3>
<p>Reticulate allows users to predefine the Python environment to be
used by entering their Python’s directory path into the <a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">following
functions</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_python</a></span><span class="op">(</span><span class="va">python</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_virtualenv</a></span><span class="op">(</span><span class="va">virtualenv</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_condaenv</a></span><span class="op">(</span><span class="va">condaenv</span><span class="op">)</span></span>
<span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/use_python.html" class="external-link">use_miniconda</a></span><span class="op">(</span><span class="va">condaenv</span><span class="op">)</span></span></code></pre></div>
<p>These functions must be executed before <code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code> is
run in the R session. The latter function should then automatically
assume that a version of Python is correctly installed and only ask for
other packages to be downloaded/installed if they are missing. To check
the Python installation that is being used, users can run:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_config.html" class="external-link">py_config</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This will print the information and path of the Python environment
reticulate is currently using. If that is still not the path specified
in the functions listed above, users should try restarting R and/or
clearing the R workspace first.</p>
</div>
<div class="section level3">
<h3 id="b--if-the-vwrfirstrun-installations-were-already-done-before">b. If the VWRfirstrun() installations were already done before<a class="anchor" aria-label="anchor" href="#b--if-the-vwrfirstrun-installations-were-already-done-before"></a>
</h3>
<p>If Python or Miniconda was already installed using
<code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code>, users will not be able to modify the Python
path in the above manner. That is because the path to the user-selected
default or custom installations is saved in order to conveniently access
them again later. Every time <code><a href="../reference/VWRfirstrun.html">VWRfirstrun()</a></code> is run, it will
read and use such saved paths. This also depends on whether the user
created a default ephemeral environment or chose a manual
Python/Miniconda installation.</p>
<ul>
<li><strong>If the user installed a Miniconda or Python environment in
the classic way</strong></li>
</ul>
<p>The paths to these installations are saved inside the
<code>.Renviron</code> file, in the standard path generated via:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/userdir.html" class="external-link">R_user_dir</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">'VertexWiseR'</span><span class="op">)</span></span></code></pre></div>
<p>Within the <code>.Renviron</code> file, the environment variables
will be written in this manner:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RETICULATE_MINICONDA_PATH</span><span class="op">=</span><span class="st">"C:/path_to_miniconda/"</span></span>
<span><span class="va">RETICULATE_PYTHON_FALLBACK</span><span class="op">=</span><span class="st">"C:/path_to_miniconda/"</span></span>
<span><span class="va">RETICULATE_PYTHON</span><span class="op">=</span><span class="st">"C:/path_to_miniconda/python.exe"</span></span></code></pre></div>
<p>To swap with another Python environment, users may choose to edit
<code>.Renviron</code> directly, by replacing the paths with the Python
installation they would like VertexWiseR to use instead. The
<code>RETICULATE_MINICONDA_PATH</code> may also be safely removed if a
non-conda Python library is to be used. Alternatively, users may choose
to completely remove the <code>.Renviron</code> and redefine the path as
described in section 3a.</p>
<ul>
<li><strong>If the user created an ephemeral virtual
environment</strong></li>
</ul>
<p>This is in the case that users chose the virtual environment
installation proposed by VWRfirstrun(), which calls
reticulate::py_require(). The path to such environment is accessible
with that command line:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/userdir.html" class="external-link">R_user_dir</a></span><span class="op">(</span><span class="st">"reticulate"</span>, <span class="st">"cache"</span><span class="op">)</span></span></code></pre></div>
<p>To stop using this environment, users may choose to clear the cache
completely:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/userdir.html" class="external-link">R_user_dir</a></span><span class="op">(</span><span class="st">"reticulate"</span>, <span class="st">"cache"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If they do not wish to get rid of the previous virtual environment,
users will have to modify and/or remove the VIRTUAL_ENV variable which
has been stored in the <code>.Renviron</code> file, in the standard path
generated via:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/userdir.html" class="external-link">R_user_dir</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">'VertexWiseR'</span><span class="op">)</span></span></code></pre></div>
<p>This variable is automatically removed when the virtual environment
can no longer be found in the cache, but will automatically be used by
VWRfirstrun() after its installation to speed up the process, if it
still exists. So the VIRTUAL_ENV variable must be rewritten to the new
ephemeral environment generated by py_require() to use the latter.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References:<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ushey_reticulate_2023" class="csl-entry">
Ushey, K, J Allaire, and Y Tang. 2023. <span>“Reticulate:
<span>Interface</span> to ’<span>Python</span>’.”</span> <a href="https://CRAN.R-project.org/package=reticulate" class="external-link">https://CRAN.R-project.org/package=reticulate</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Junhong Yu, Charly Billaud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
