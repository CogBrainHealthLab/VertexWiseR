% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RFT_vertex_analysis_f.R
\name{RFT_vertex_analysis_f}
\alias{RFT_vertex_analysis_f}
\title{Vertex-wise analysis with random field theory cluster correction (formula)}
\usage{
RFT_vertex_analysis_f(
  formula,
  dataset,
  surf_data,
  p = 0.05,
  atlas = 1,
  smooth_FWHM,
  VWR_check = TRUE
)
}
\arguments{
\item{formula}{A string or formula object describing the predictors to be fitted against the surface data:
\itemize{
\item The dependent variable can have any name, it will always be the surface data values.
\item The first independent variable in the formula will always be interpreted as the contrast of interest for which to estimate cluster-thresholded t-stat maps.
\item Only one random regressor can be given and must be indicated as '(1|variable_name)'.
}}

\item{dataset}{A data.frame object where the independent variables or predictors are stored (each IV's column names has to match the formula names).}

\item{surf_data}{A N x M matrix object containing the surface data (N row for each subject, M for each vertex), in fsaverage5 (20484 vertices), fsaverage6 (81924 vertices), fslr32k (64984 vertices) or hippocampal (14524 vertices) space. See also Hipvextract() or SURFvextract() output format.}

\item{p}{A numeric object specifying the p-value to threshold the results (Default is 0.05)}

\item{atlas}{A numeric integer object corresponding to the atlas of interest. 1=Desikan, 2=Schaefer-100, 3=Schaefer-200, 4=Glasser-360, 5=Destrieux-148.}

\item{smooth_FWHM}{A numeric vector object specifying the desired smoothing width in mm}

\item{VWR_check}{A boolean object specifying whether to check and validate system requirements. Default is TRUE.}
}
\value{
A list object containing the cluster level results, thresholded t-stat map, and positive, negative and bidirectional cluster maps. Additionally, the formula and 'model' object based on the formula is included.
}
\description{
Alternative function to RFT_vertex_analysis() where a dataset and formula arguments can be provided instead of contrast or model.
}
\details{
Output definitions:
\itemize{
\item \code{nverts}: number of vertices in the cluster
\item \code{P}: p-value of the cluster
\item \verb{X, Y and Z}: MNI coordinates of the vertex with the highest t-statistic in the cluster.
\item \code{tstat}: t statistic of the vertex with the highest t-statistic in the cluster
\item \code{region}: the region this highest -statistic vertex is located in, as determined/labelled by the selected atlas
}
}
\examples{
formula= as.formula("thickness ~ age + sex")
demodata = readRDS(system.file('demo_data/SPRENG_behdata_site1.rds', 
                              package = 'VertexWiseR'))
CTv = readRDS(file = url(paste0("https://github.com",
"/CogBrainHealthLab/VertexWiseR/blob/main/inst/demo_data/",
"SPRENG_CTv_site1.rds?raw=TRUE")))

vertexwise_model=RFT_vertex_analysis_f(
  formula=formula, 
  dataset=demodata, 
  smooth_FWHM=10,
  surf_data = CTv, 
  p = 0.05,
  VWR_check=FALSE)

#Description of the output:
#vertexwise_model$cluster_level_results

}
\seealso{
\code{\link{RFT_vertex_analysis}}
}
