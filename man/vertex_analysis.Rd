% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vertwise.R
\name{vertex_analysis}
\alias{vertex_analysis}
\title{Vertex-wise analysis}
\usage{
vertex_analysis(
  model,
  contrast,
  random,
  surf_data,
  p = 0.05,
  atlas = 1,
  smooth_FWHM
)
}
\arguments{
\item{model}{A data.frame object containing the variables to include in the model at each column, and rows of values assigned to each participant.}

\item{contrast}{An object containing the values of the independent variable of interest for which to fit a contrast}

\item{random}{An object containing the values of the random variable (optional)}

\item{surf_data}{A matrix object containing the surface data, see SURFvextract() output format.}

\item{p}{A numeric object stating the p-value threshold for the linear model and cluster-correction}

\item{atlas}{A numeric integer object corresponding to the atlas of interest. 1=Desikan, 2=Schaefer-100, 3=Schaefer-200, 4=Glasser-360, 5=Destrieux-148.}

\item{smooth_FWHM}{A numeric vector object containing the desired smoothing width in mm}
}
\value{
A list object containing summary statistics for each significant cluster, a threshold t value map, positive and negative results maps, positive and negative clusters maps, which can be plotted with plot_surf().
}
\description{
Fits a model with the whole-brain and hippocampal surface data in template space. The data is smoothed and fit to a linear model with fixed or mixed effects, and returns a brain-wide or hippocampal t-value maps, as well as random field theory cluster maps.
}
\details{
The function imports and adapts the \href{https://brainstat.readthedocs.io/en/master/_modules/brainstat/stats/SLM.html#SLM)}{brainstat python library}.
}
\examples{
model=vertex_analysis(model = dat_beh[,2:3], contrast = dat_beh$Age, random = dat_beh$SUB_ID, surf_data = dat_CT,p = 0.01, atlas=1)

model$cluster_level_results

plot_surf(surf_data = model$pos_clusterIDmap, filename = 'pos_clusters.png', title='Positive clusters', surface = 'inflated')

}
