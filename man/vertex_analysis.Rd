% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vertwise.R
\name{vertex_analysis}
\alias{vertex_analysis}
\title{Vertex-wise analysis}
\usage{
vertex_analysis(
  model,
  contrast,
  random,
  surf_data,
  p = 0.05,
  atlas = 1,
  smooth_FWHM
)
}
\arguments{
\item{model}{A data.frame object containing the variables to include in the model at each column, and rows of values assigned to each participant.}

\item{contrast}{An object containing the values of the independent variable of interest for which to fit a contrast}

\item{random}{An object containing the values of the random variable (optional)}

\item{surf_data}{A matrix object containing the surface data, see SURFvextract() output format.}

\item{p}{A numeric object stating the p-value threshold for the linear model and cluster-correction}

\item{atlas}{A numeric integer object corresponding to the atlas of interest. 1=Desikan, 2=Schaefer-100, 3=Schaefer-200, 4=Glasser-360, 5=Destrieux-148.}

\item{smooth_FWHM}{A numeric vector object containing the desired smoothing width in mm}
}
\value{
A list object containing summary statistics for each significant cluster, a threshold t value map, positive and negative results maps, positive, negative and bidirectional clusters maps, which can be plotted with plot_surf().
}
\description{
Fits a model with the whole-brain and hippocampal surface data in template space. The data is smoothed and fit to a linear model with fixed or mixed effects, and returns a brain-wide or hippocampal t-value maps, as well as random field theory cluster maps.
}
\details{
The function imports and adapts the \href{https://brainstat.readthedocs.io/en/master/_modules/brainstat/stats/SLM.html#SLM)}{brainstat python library}.

Output definitions:
\itemize{
\item \code{nverts}: number of vertices in the cluster
\item \code{P}: p-value of the cluster
\item \verb{X, Y and Z}: MNI coordinates of the vertex with the highest t-stat in the cluster.
\item \code{tstat}: t statistic of the vertex with the highest t-stat in the cluster
\item \code{region}: the region this highest t-stat vertex is located in, as determined/labelled by the selected atlas
}
}
\examples{
demodata = read.csv(system.file('demo_data/SPRENG_behdata.csv',
package = 'VertexWiseR'))[1:100,]
CTv = readRDS(file = url(paste0("https://github.com",
"/CogBrainHealthLab/VertexWiseR/blob/main/inst/demo_data/",
"SPRENG_CTv.rds?raw=TRUE")))[1:100,]

vertexwise_model=vertex_analysis(model=demodata[,c(2,7)], 
contrast=demodata[,7], surf_data = CTv, atlas=1,p = 0.05, 
smooth_FWHM = 10)
print(vertexwise_model$cluster_level_results)
}
